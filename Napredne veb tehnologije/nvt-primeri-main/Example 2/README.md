# InfluxDB example

This examples demonstrates storing data in InfluxDB time series database and querying previously stored data.

## Applications

### influxdb-example

This is Spring Boot application that stores randomly generated data into InfluxDB database. Random values for measurements are periodically generated by background task. Application allows retrieving latest data using WebSocket protocol.

It has API with two actions:

- `GET /measurements/10?name={value}` - gets last 10 records for measurements with name *value*
- `GET /measurements/last?name={value}` - gets last record for measurement with name *value*
- `GET /measurements/aggregated?name={value}` - gets aggregated data (where data are being grouped by 1 minute interval and for each group mean value is calculated) for measurements with name *value*
- `GET /measurements/deviation?name={value}` - gets deviation from mean value for each of last 10 records for measurement with name *value*


Directory **postman** provides collection of Postman requests to test the API.

### client
This is a simple html page with JavaScript code that receives selected records of measurements and presents them to user.

## Requirements

* Java 17
* Maven
* [InfluxDB database - version 2.7](https://www.influxdata.com/) listening on port 8086

## Setup

1. Install Java and Maven
2. Install InfluxDB
   - Follow instructions on how to install and start InfluxDB written in [documentation](https://docs.influxdata.com/influxdb/v2/install/) (in case of running commands in terminal, it could require Administrator permissions)
   - When starting InfluxDB, make sure that Antivirus or some firewall does not block accessing application
   - After InfluxDB is started, open in browser `localhost:8086` (default port po InfluxDB is **8086**) and finish the setup procedure that will ask for credentials and other required data for the database; in this example following information are used:
      - username - `client`
      - password - `password`
      - organization - `nwt`
      - bucket - `measurements`
   - InfluxDB will generate access token in one of the step - **save it** since it is required for communication with database
   - Set required information in **application.properties** (`inflxudb.host`, `inflxudb.port`, `inflxudb.organization`, `inflxudb.bucket` and `inflxudb.token`)
3. Load dependencies of Spring Boot application (`pom.xml`) with Maven and start application
4. Open `index.html` in browser (*client* directory), select measurement and data types and click *Fetch* button
v